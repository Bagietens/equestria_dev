scripted_gui = {
	ZAR_state_action_worm_looting_greyed_gui = {
		context_type = selected_state_context
		parent_window_token = selected_state_view
		window_name = "ZAR_state_action_worm_looting_greyed"
		
		visible = {
			ROOT = { 
				has_country_flag = ZAR_worm_looting_allowed
				original_tag = ZAR 
			}
		}
		
	}


	ZAR_state_action_worm_looting_usable_gui = {
		context_type = selected_state_context
		parent_window_token = selected_state_view
		window_name = "ZAR_state_action_worm_looting_usable"
		
		visible = {
			ROOT = { 
				has_country_flag = ZAR_worm_looting_allowed
				original_tag = ZAR
			}
			NOT = {
				is_core_of = ZAR
			}
			is_fully_controlled_by = ZAR
		}


		effects = {
			ZAR_looting_button_clickable_click = {
				ROOT = {
					add_manpower = -500
					add_command_power = -25
				}
			}
		}
	}


	ZAR_state_action_worm_nuking_greyed_gui = {
		context_type = selected_state_context
		parent_window_token = selected_state_view
		window_name = "ZAR_state_action_worm_nuking_greyed"
		
		visible = {
			ROOT = { 
				has_country_flag = ZAR_the_eldest_come_flag
				original_tag = ZAR 
			}
		}
		
	}	

	ZAR_state_action_worm_nuking_usable_gui = {
		context_type = selected_state_context
		parent_window_token = selected_state_view
		window_name = "ZAR_state_action_worm_nuking_usable"
		
		visible = {
			ROOT = { 
				has_country_flag = ZAR_the_eldest_come_flag
				original_tag = ZAR 
				command_power > 29
				has_equipment = {
					dragon_equipment > 14
				}
				check_variable = { ZAR_WORM_state_being_nuked < 3}
			}
			NOT = {
				is_core_of = ZAR
				has_dynamic_modifier = {
					modifier = ZAR_worm_nuking_in_progress
				}
			}				
			OR = {
				owner = {
					has_war_with = ZAR
				}
				controller = {
					has_war_with = ZAR
				}
			}
		}


		effects = {
			ZAR_nuking_button_clickable_click = {
				hidden_effect = {
					ROOT = {
						add_command_power = -30
						add_equipment_to_stockpile = {
							type = dragon_equipment
							amount = -15
						}
						#This is a bit disgusting but it works
						#if = { 
						#	limit = { NOT = { has_country_flag = ZAR_WORM_nuke_1 } }
						#	set_country_flag = ZAR_WORM_nuke_1
						#	country_event = { id = zarantia_worm.8991 days = 24 }
						#}
						#else_if = { 
						#	limit = { NOT = { has_country_flag = ZAR_WORM_nuke_2 } }
						#	set_country_flag = ZAR_WORM_nuke_2
						#	country_event = { id = zarantia_worm.8992 days = 24 }
						#}
						#else_if = { 
						#	limit = { NOT = { has_country_flag = ZAR_WORM_nuke_3 } }
						#	set_country_flag = ZAR_WORM_nuke_3
						#	country_event = { id = zarantia_worm.8993 days = 24 }
						#}
						#add_to_variable = { ZAR_WORM_state_being_nuked = 1 }
					}
					damage_units = {
						state = FROM  
						damage = 0.2
						org_damage = 0.2
						str_damage = 0.2
						army = yes
					}
					state_event = {
						id = zarantia_worm.899
						days = 3
						trigger_for = owner
					}
					state_event = {
						id = zarantia_worm.899
						days = 6
						trigger_for = owner
					}
					state_event = {
						id = zarantia_worm.899
						days = 9
						trigger_for = owner
					}
					state_event = {
						id = zarantia_worm.899
						days = 12
						trigger_for = owner
					}
					state_event = {
						id = zarantia_worm.899
						days = 15
						trigger_for = owner
					}
					state_event = {
						id = zarantia_worm.899
						days = 18
						trigger_for = owner
					}
					state_event = {
						id = zarantia_worm.899
						days = 21
						trigger_for = owner
					}
					add_dynamic_modifier = {
						modifier = ZAR_worm_nuking_in_progress
						days = 24
					}
					
				}
				custom_effect_tooltip = ZAR_unleash_the_wurms_tt
			}
		}
		
	}
}



